components:
  schemas:
    CreateDemandLetterRequest:
      type: object
      required:
        - title
      properties:
        title:
          type: string
          minLength: 1
          maxLength: 500
          description: Demand letter title
          example: Smith v. XYZ Insurance - Demand for Settlement
        templateId:
          type: string
          format: uuid
          description: Template ID to use (optional)
          example: a1b2c3d4-e5f6-7890-abcd-ef1234567890
        documentIds:
          type: array
          description: Source documents to analyze (optional, can be added later)
          items:
            type: string
            format: uuid
          example:
            - 8f7e6d5c-4b3a-2c1d-0e9f-8a7b6c5d4e3f

    AnalyzeDemandLetterRequest:
      type: object
      required:
        - documentIds
      properties:
        documentIds:
          type: array
          description: Document IDs to analyze
          minItems: 1
          items:
            type: string
            format: uuid
          example:
            - 8f7e6d5c-4b3a-2c1d-0e9f-8a7b6c5d4e3f
            - 9e8d7c6b-5a4f-3e2d-1c0b-9a8f7e6d5c4b

    GenerateDemandLetterRequest:
      type: object
      properties:
        templateId:
          type: string
          format: uuid
          description: Template ID to use for generation
          example: a1b2c3d4-e5f6-7890-abcd-ef1234567890
        customInstructions:
          type: string
          maxLength: 2000
          description: Custom instructions for AI generation
          example: Focus on emotional distress and lost wages. Use formal tone.
        tone:
          type: string
          enum: [formal, assertive, conciliatory]
          description: Desired tone for the letter
          example: assertive
          default: formal

    RefineDemandLetterRequest:
      type: object
      required:
        - feedback
      properties:
        feedback:
          type: string
          minLength: 1
          maxLength: 2000
          description: Feedback for refining the letter
          example: Add more detail about medical expenses and make the damages section more specific.
        sections:
          type: array
          description: Specific sections to refine (optional)
          items:
            type: string
          example:
            - damages
            - medical_expenses

    DemandLetterResponse:
      type: object
      required:
        - id
        - title
        - status
        - firmId
        - createdBy
        - createdAt
      properties:
        id:
          type: string
          format: uuid
          description: Demand letter ID
          example: b2c3d4e5-f6a7-8901-bcde-f2345678901a
        title:
          type: string
          description: Demand letter title
          example: Smith v. XYZ Insurance - Demand for Settlement
        status:
          type: string
          enum: [draft, analyzing, generating, refining, complete, archived]
          description: Current workflow status
          example: generating
        content:
          type: string
          description: Current letter content (null until generated)
          nullable: true
        extractedData:
          type: object
          description: Data extracted from source documents
          nullable: true
          additionalProperties: true
        templateId:
          type: string
          format: uuid
          description: Template ID used
          nullable: true
          example: a1b2c3d4-e5f6-7890-abcd-ef1234567890
        documentIds:
          type: array
          description: Associated source documents
          items:
            type: string
            format: uuid
        firmId:
          type: string
          format: uuid
          description: Firm ID
          example: 123e4567-e89b-12d3-a456-426614174000
        createdBy:
          type: string
          format: uuid
          description: User ID who created the letter
          example: 7c9e6679-7425-40de-944b-e07fc1f90ae7
        createdAt:
          type: string
          format: date-time
          description: Creation timestamp
          example: 2024-01-20T11:00:00Z
        updatedAt:
          type: string
          format: date-time
          description: Last update timestamp
          example: 2024-01-20T14:30:00Z
        completedAt:
          type: string
          format: date-time
          description: Completion timestamp
          nullable: true
          example: 2024-01-21T09:00:00Z

    DemandLetterListResponse:
      type: object
      required:
        - letters
        - total
      properties:
        letters:
          type: array
          items:
            $ref: '#/components/schemas/DemandLetterResponse'
        total:
          type: integer
          description: Total number of letters
          example: 28
        limit:
          type: integer
          description: Page size
          example: 20
        offset:
          type: integer
          description: Number of items skipped
          example: 0

    DemandLetterStatusResponse:
      type: object
      required:
        - id
        - status
        - updatedAt
      properties:
        id:
          type: string
          format: uuid
          description: Demand letter ID
          example: b2c3d4e5-f6a7-8901-bcde-f2345678901a
        status:
          type: string
          enum: [draft, analyzing, generating, refining, complete, archived]
          description: Current workflow status
          example: generating
        progress:
          type: integer
          minimum: 0
          maximum: 100
          description: Progress percentage
          example: 75
        message:
          type: string
          description: Status message
          example: Generating letter content from template...
        updatedAt:
          type: string
          format: date-time
          description: Last update timestamp
          example: 2024-01-20T14:35:00Z

    DemandLetterRevisionHistoryResponse:
      type: object
      required:
        - revisions
        - total
      properties:
        revisions:
          type: array
          items:
            type: object
            required:
              - id
              - version
              - content
              - createdAt
              - createdBy
            properties:
              id:
                type: string
                format: uuid
                description: Revision ID
                example: c3d4e5f6-a7b8-9012-cdef-3456789012ab
              version:
                type: integer
                description: Revision version number
                example: 3
              content:
                type: string
                description: Letter content at this revision
              changeType:
                type: string
                enum: [generated, refined, manual_edit]
                description: Type of change
                example: refined
              feedback:
                type: string
                description: Feedback that led to this revision
                nullable: true
              createdAt:
                type: string
                format: date-time
                description: Revision creation timestamp
                example: 2024-01-20T15:00:00Z
              createdBy:
                type: string
                format: uuid
                description: User who created this revision
                example: 7c9e6679-7425-40de-944b-e07fc1f90ae7
        total:
          type: integer
          description: Total number of revisions
          example: 4

    ExportDemandLetterRequest:
      type: object
      required:
        - format
      properties:
        format:
          type: string
          enum: [docx, pdf]
          description: Export format
          example: pdf

    ExportDemandLetterResponse:
      type: object
      required:
        - downloadUrl
        - format
        - expiresAt
      properties:
        downloadUrl:
          type: string
          format: uri
          description: Pre-signed S3 URL for download (valid for 1 hour)
          example: https://s3.amazonaws.com/bucket/exports/letter.pdf?signature=...
        format:
          type: string
          enum: [docx, pdf]
          description: File format
          example: pdf
        filename:
          type: string
          description: Generated filename
          example: Smith_v_XYZ_Demand_Letter_2024-01-20.pdf
        expiresAt:
          type: string
          format: date-time
          description: URL expiration timestamp
          example: 2024-01-20T16:30:00Z
